INFO:root:Namespace(aggregation='max', batch_size=256, debug=False, device=device(type='cpu'), dropout=0.1, epochs=50, hidden_size=128, in_features=17, kernel_size=3, log_dir='exps/logs', lr=0.0001, model='GRU', num_channels=[64, 64, 128], num_classes=2, num_layers=2, num_workers=4, print_freq=5, root='data', save_dir='exps/chpts/GRU_layers2_stride5_max_lr0.0001', seed=14, start_epoch=0, tb_dir='exps/tb/GRU_layers2_stride5_max_lr0.0001', temp_stride=5)
INFO:root:GRU(
  (rnn): GRU(17, 128, num_layers=2, batch_first=True)
  (fc): Linear(in_features=128, out_features=2, bias=True)
  (avg_pool): AdaptiveAvgPool1d(output_size=1)
  (max_pool): AdaptiveMaxPool1d(output_size=1)
)
INFO:root:=> Loading 4792 samples for train
INFO:root:=> Loading 626 samples for val
INFO:root:=> Loading 1166 samples for test
INFO:root:TRAIN | Epoch: [0/50] | Loss: 0.6886 | AP: 42.10 | TP:91.06, FP:141.63, FN:8.60, TN:11.95 | ACC: 40.67
INFO:root:VAL   | Epoch: [0/50] | Loss: 0.6914 | AP: 31.60 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (31.60) improved at epoch 0 | saving best model!
INFO:root:TRAIN | Epoch: [1/50] | Loss: 0.6814 | AP: 46.65 | TP:99.67, FP:153.21, FN:0.11, TN:0.25 | ACC: 39.42
INFO:root:VAL   | Epoch: [1/50] | Loss: 0.6929 | AP: 31.98 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (31.98) improved at epoch 1 | saving best model!
INFO:root:TRAIN | Epoch: [2/50] | Loss: 0.6788 | AP: 47.90 | TP:97.84, FP:149.75, FN:1.86, TN:3.78 | ACC: 40.13
INFO:root:VAL   | Epoch: [2/50] | Loss: 0.6953 | AP: 32.54 | TP:121.5, FP:170.5, FN:7.5, TN:13.5 | ACC: 43.13
INFO:root:=> AP improved (32.54) improved at epoch 2 | saving best model!
INFO:root:TRAIN | Epoch: [3/50] | Loss: 0.6755 | AP: 49.44 | TP:94.16, FP:138.62, FN:5.47, TN:14.98 | ACC: 43.09
INFO:root:VAL   | Epoch: [3/50] | Loss: 0.6973 | AP: 33.66 | TP:115.5, FP:164.5, FN:13.5, TN:19.5 | ACC: 43.13
INFO:root:=> AP improved (33.66) improved at epoch 3 | saving best model!
INFO:root:TRAIN | Epoch: [4/50] | Loss: 0.6730 | AP: 50.37 | TP:92.63, FP:133.01, FN:7.07, TN:20.53 | ACC: 44.68
INFO:root:VAL   | Epoch: [4/50] | Loss: 0.6996 | AP: 33.50 | TP:115.0, FP:165.0, FN:14.0, TN:19.0 | ACC: 42.81
INFO:root:TRAIN | Epoch: [5/50] | Loss: 0.6705 | AP: 50.47 | TP:89.74, FP:124.30, FN:9.93, TN:29.27 | ACC: 46.97
INFO:root:VAL   | Epoch: [5/50] | Loss: 0.7008 | AP: 34.25 | TP:106.5, FP:153.5, FN:22.5, TN:30.5 | ACC: 43.77
INFO:root:=> AP improved (34.25) improved at epoch 5 | saving best model!
INFO:root:TRAIN | Epoch: [6/50] | Loss: 0.6679 | AP: 51.68 | TP:86.89, FP:116.86, FN:12.90, TN:36.58 | ACC: 48.69
INFO:root:VAL   | Epoch: [6/50] | Loss: 0.7004 | AP: 35.24 | TP:111.0, FP:156.5, FN:18.0, TN:27.5 | ACC: 44.25
INFO:root:=> AP improved (35.24) improved at epoch 6 | saving best model!
INFO:root:TRAIN | Epoch: [7/50] | Loss: 0.6662 | AP: 51.71 | TP:86.15, FP:116.84, FN:13.48, TN:36.77 | ACC: 48.52
INFO:root:VAL   | Epoch: [7/50] | Loss: 0.7059 | AP: 35.38 | TP:100.0, FP:149.0, FN:29.0, TN:35.0 | ACC: 43.13
INFO:root:=> AP improved (35.38) improved at epoch 7 | saving best model!
INFO:root:TRAIN | Epoch: [8/50] | Loss: 0.6648 | AP: 52.14 | TP:82.96, FP:109.70, FN:16.75, TN:43.81 | ACC: 50.06
INFO:root:VAL   | Epoch: [8/50] | Loss: 0.7061 | AP: 36.24 | TP:101.5, FP:152.0, FN:27.5, TN:32.0 | ACC: 42.65
INFO:root:=> AP improved (36.24) improved at epoch 8 | saving best model!
INFO:root:TRAIN | Epoch: [9/50] | Loss: 0.6619 | AP: 53.29 | TP:86.27, FP:115.35, FN:13.25, TN:38.36 | ACC: 49.27
INFO:root:VAL   | Epoch: [9/50] | Loss: 0.7070 | AP: 36.63 | TP:94.5, FP:141.0, FN:34.5, TN:43.0 | ACC: 43.93
INFO:root:=> AP improved (36.63) improved at epoch 9 | saving best model!
INFO:root:TRAIN | Epoch: [10/50] | Loss: 0.6596 | AP: 53.68 | TP:83.87, FP:108.68, FN:15.77, TN:44.91 | ACC: 50.83
INFO:root:VAL   | Epoch: [10/50] | Loss: 0.7088 | AP: 36.91 | TP:97.0, FP:148.0, FN:32.0, TN:36.0 | ACC: 42.49
INFO:root:=> AP improved (36.91) improved at epoch 10 | saving best model!
INFO:root:TRAIN | Epoch: [11/50] | Loss: 0.6576 | AP: 54.28 | TP:83.15, FP:105.90, FN:16.62, TN:47.58 | ACC: 51.54
INFO:root:VAL   | Epoch: [11/50] | Loss: 0.7109 | AP: 37.04 | TP:94.0, FP:149.5, FN:35.0, TN:34.5 | ACC: 41.05
INFO:root:=> AP improved (37.04) improved at epoch 11 | saving best model!
INFO:root:TRAIN | Epoch: [12/50] | Loss: 0.6584 | AP: 53.45 | TP:81.80, FP:103.34, FN:17.96, TN:50.13 | ACC: 52.09
INFO:root:VAL   | Epoch: [12/50] | Loss: 0.7096 | AP: 38.41 | TP:90.5, FP:141.5, FN:38.5, TN:42.5 | ACC: 42.49
INFO:root:=> AP improved (38.41) improved at epoch 12 | saving best model!
INFO:root:TRAIN | Epoch: [13/50] | Loss: 0.6546 | AP: 55.07 | TP:83.26, FP:105.86, FN:16.38, TN:47.73 | ACC: 51.73
INFO:root:VAL   | Epoch: [13/50] | Loss: 0.7135 | AP: 38.09 | TP:90.0, FP:142.0, FN:39.0, TN:42.0 | ACC: 42.17
INFO:root:TRAIN | Epoch: [14/50] | Loss: 0.6550 | AP: 54.91 | TP:81.07, FP:100.95, FN:18.52, TN:52.70 | ACC: 52.88
INFO:root:VAL   | Epoch: [14/50] | Loss: 0.7134 | AP: 37.73 | TP:89.0, FP:140.0, FN:40.0, TN:44.0 | ACC: 42.49
INFO:root:TRAIN | Epoch: [15/50] | Loss: 0.6525 | AP: 55.13 | TP:81.31, FP:101.40, FN:18.24, TN:52.29 | ACC: 52.80
INFO:root:VAL   | Epoch: [15/50] | Loss: 0.7179 | AP: 38.68 | TP:86.5, FP:140.5, FN:42.5, TN:43.5 | ACC: 41.53
INFO:root:=> AP improved (38.68) improved at epoch 15 | saving best model!
INFO:root:TRAIN | Epoch: [16/50] | Loss: 0.6504 | AP: 56.00 | TP:80.83, FP:97.15, FN:18.78, TN:56.47 | ACC: 54.26
INFO:root:VAL   | Epoch: [16/50] | Loss: 0.7214 | AP: 38.41 | TP:89.5, FP:138.0, FN:39.5, TN:46.0 | ACC: 43.29
INFO:root:TRAIN | Epoch: [17/50] | Loss: 0.6481 | AP: 56.46 | TP:80.82, FP:98.38, FN:18.76, TN:55.27 | ACC: 53.78
INFO:root:VAL   | Epoch: [17/50] | Loss: 0.7251 | AP: 39.04 | TP:76.5, FP:129.5, FN:52.5, TN:54.5 | ACC: 41.85
INFO:root:=> AP improved (39.04) improved at epoch 17 | saving best model!
INFO:root:TRAIN | Epoch: [18/50] | Loss: 0.6467 | AP: 56.83 | TP:80.32, FP:96.17, FN:19.36, TN:57.39 | ACC: 54.44
INFO:root:VAL   | Epoch: [18/50] | Loss: 0.7292 | AP: 37.93 | TP:81.5, FP:136.5, FN:47.5, TN:47.5 | ACC: 41.21
INFO:root:TRAIN | Epoch: [19/50] | Loss: 0.6501 | AP: 55.69 | TP:78.52, FP:92.74, FN:21.26, TN:60.72 | ACC: 54.97
INFO:root:VAL   | Epoch: [19/50] | Loss: 0.7313 | AP: 37.88 | TP:83.5, FP:138.5, FN:45.5, TN:45.5 | ACC: 41.21
INFO:root:TRAIN | Epoch: [20/50] | Loss: 0.6450 | AP: 56.69 | TP:78.78, FP:91.14, FN:20.89, TN:62.43 | ACC: 55.68
INFO:root:VAL   | Epoch: [20/50] | Loss: 0.7377 | AP: 38.07 | TP:83.5, FP:137.0, FN:45.5, TN:47.0 | ACC: 41.69
INFO:root:TRAIN | Epoch: [21/50] | Loss: 0.6436 | AP: 57.38 | TP:79.01, FP:91.87, FN:20.56, TN:61.80 | ACC: 55.61
INFO:root:VAL   | Epoch: [21/50] | Loss: 0.7352 | AP: 38.80 | TP:74.0, FP:128.0, FN:55.0, TN:56.0 | ACC: 41.53
INFO:root:TRAIN | Epoch: [22/50] | Loss: 0.6418 | AP: 57.80 | TP:78.70, FP:90.64, FN:20.88, TN:63.01 | ACC: 55.99
INFO:root:VAL   | Epoch: [22/50] | Loss: 0.7358 | AP: 38.75 | TP:80.0, FP:132.0, FN:49.0, TN:52.0 | ACC: 42.17
INFO:root:TRAIN | Epoch: [23/50] | Loss: 0.6419 | AP: 58.06 | TP:76.58, FP:86.48, FN:22.85, TN:67.32 | ACC: 56.84
INFO:root:VAL   | Epoch: [23/50] | Loss: 0.7457 | AP: 37.45 | TP:83.0, FP:138.0, FN:46.0, TN:46.0 | ACC: 41.21
INFO:root:TRAIN | Epoch: [24/50] | Loss: 0.6388 | AP: 58.38 | TP:79.60, FP:91.45, FN:20.20, TN:61.99 | ACC: 55.86
INFO:root:VAL   | Epoch: [24/50] | Loss: 0.7372 | AP: 38.91 | TP:75.0, FP:123.0, FN:54.0, TN:61.0 | ACC: 43.45
INFO:root:TRAIN | Epoch: [25/50] | Loss: 0.6410 | AP: 57.96 | TP:77.14, FP:85.96, FN:22.49, TN:67.64 | ACC: 57.10
INFO:root:VAL   | Epoch: [25/50] | Loss: 0.7463 | AP: 39.27 | TP:77.5, FP:133.0, FN:51.5, TN:51.0 | ACC: 41.05
INFO:root:=> AP improved (39.27) improved at epoch 25 | saving best model!
INFO:root:TRAIN | Epoch: [26/50] | Loss: 0.6395 | AP: 57.88 | TP:76.93, FP:84.35, FN:22.56, TN:69.39 | ACC: 57.83
INFO:root:VAL   | Epoch: [26/50] | Loss: 0.7407 | AP: 38.68 | TP:73.5, FP:125.0, FN:55.5, TN:59.0 | ACC: 42.33
INFO:root:TRAIN | Epoch: [27/50] | Loss: 0.6376 | AP: 58.45 | TP:78.39, FP:86.96, FN:21.37, TN:66.51 | ACC: 57.20
INFO:root:VAL   | Epoch: [27/50] | Loss: 0.7432 | AP: 39.20 | TP:74.0, FP:125.5, FN:55.0, TN:58.5 | ACC: 42.33
INFO:root:TRAIN | Epoch: [28/50] | Loss: 0.6358 | AP: 59.04 | TP:78.59, FP:85.68, FN:21.14, TN:67.82 | ACC: 57.83
INFO:root:VAL   | Epoch: [28/50] | Loss: 0.7394 | AP: 39.17 | TP:75.0, FP:121.0, FN:54.0, TN:63.0 | ACC: 44.09
INFO:root:TRAIN | Epoch: [29/50] | Loss: 0.6354 | AP: 58.43 | TP:78.03, FP:85.97, FN:21.65, TN:67.59 | ACC: 57.53
INFO:root:VAL   | Epoch: [29/50] | Loss: 0.7404 | AP: 39.76 | TP:74.0, FP:118.0, FN:55.0, TN:66.0 | ACC: 44.73
INFO:root:=> AP improved (39.76) improved at epoch 29 | saving best model!
INFO:root:TRAIN | Epoch: [30/50] | Loss: 0.6365 | AP: 58.73 | TP:77.11, FP:84.35, FN:22.52, TN:69.25 | ACC: 57.83
INFO:root:VAL   | Epoch: [30/50] | Loss: 0.7401 | AP: 39.65 | TP:75.0, FP:126.5, FN:54.0, TN:57.5 | ACC: 42.33
INFO:root:TRAIN | Epoch: [31/50] | Loss: 0.6323 | AP: 59.53 | TP:75.58, FP:80.65, FN:23.97, TN:73.04 | ACC: 58.79
INFO:root:VAL   | Epoch: [31/50] | Loss: 0.7482 | AP: 39.17 | TP:71.0, FP:113.0, FN:58.0, TN:71.0 | ACC: 45.37
INFO:root:TRAIN | Epoch: [32/50] | Loss: 0.6324 | AP: 59.19 | TP:77.56, FP:85.44, FN:21.93, TN:68.31 | ACC: 57.60
INFO:root:VAL   | Epoch: [32/50] | Loss: 0.7458 | AP: 39.40 | TP:73.5, FP:117.0, FN:55.5, TN:67.0 | ACC: 44.89
INFO:root:TRAIN | Epoch: [33/50] | Loss: 0.6286 | AP: 60.07 | TP:78.52, FP:85.22, FN:21.04, TN:68.46 | ACC: 58.08
INFO:root:VAL   | Epoch: [33/50] | Loss: 0.7485 | AP: 39.10 | TP:70.5, FP:118.5, FN:58.5, TN:65.5 | ACC: 43.45
INFO:root:TRAIN | Epoch: [34/50] | Loss: 0.6291 | AP: 60.19 | TP:77.34, FP:81.31, FN:22.50, TN:72.09 | ACC: 58.93
INFO:root:VAL   | Epoch: [34/50] | Loss: 0.7511 | AP: 38.99 | TP:77.0, FP:119.5, FN:52.0, TN:64.5 | ACC: 45.21
INFO:root:TRAIN | Epoch: [35/50] | Loss: 0.6276 | AP: 60.43 | TP:78.28, FP:83.82, FN:21.47, TN:69.67 | ACC: 58.35
INFO:root:VAL   | Epoch: [35/50] | Loss: 0.7556 | AP: 39.35 | TP:74.0, FP:126.5, FN:55.0, TN:57.5 | ACC: 42.01
INFO:root:TRAIN | Epoch: [36/50] | Loss: 0.6300 | AP: 59.87 | TP:77.25, FP:83.19, FN:22.50, TN:70.30 | ACC: 58.28
INFO:root:VAL   | Epoch: [36/50] | Loss: 0.7513 | AP: 39.54 | TP:73.5, FP:115.5, FN:55.5, TN:68.5 | ACC: 45.37
INFO:root:TRAIN | Epoch: [37/50] | Loss: 0.6259 | AP: 60.64 | TP:76.45, FP:79.51, FN:23.31, TN:73.96 | ACC: 59.41
INFO:root:VAL   | Epoch: [37/50] | Loss: 0.7501 | AP: 40.66 | TP:75.5, FP:121.0, FN:53.5, TN:63.0 | ACC: 44.25
INFO:root:=> AP improved (40.66) improved at epoch 37 | saving best model!
INFO:root:TRAIN | Epoch: [38/50] | Loss: 0.6252 | AP: 61.02 | TP:77.47, FP:79.95, FN:22.34, TN:73.48 | ACC: 59.58
INFO:root:VAL   | Epoch: [38/50] | Loss: 0.7582 | AP: 38.73 | TP:77.5, FP:120.0, FN:51.5, TN:64.0 | ACC: 45.21
INFO:root:TRAIN | Epoch: [39/50] | Loss: 0.6249 | AP: 60.89 | TP:77.44, FP:80.64, FN:22.24, TN:72.92 | ACC: 59.39
INFO:root:VAL   | Epoch: [39/50] | Loss: 0.7538 | AP: 40.30 | TP:73.0, FP:114.0, FN:56.0, TN:70.0 | ACC: 45.69
INFO:root:TRAIN | Epoch: [40/50] | Loss: 0.6215 | AP: 61.71 | TP:78.83, FP:81.65, FN:20.83, TN:71.92 | ACC: 59.62
INFO:root:VAL   | Epoch: [40/50] | Loss: 0.7567 | AP: 39.71 | TP:68.0, FP:113.5, FN:61.0, TN:70.5 | ACC: 44.25
INFO:root:TRAIN | Epoch: [41/50] | Loss: 0.6244 | AP: 61.65 | TP:78.31, FP:82.95, FN:21.34, TN:70.63 | ACC: 58.83
INFO:root:VAL   | Epoch: [41/50] | Loss: 0.7535 | AP: 40.56 | TP:74.5, FP:115.5, FN:54.5, TN:68.5 | ACC: 45.69
INFO:root:TRAIN | Epoch: [42/50] | Loss: 0.6213 | AP: 62.30 | TP:76.97, FP:78.86, FN:22.68, TN:74.71 | ACC: 59.93
INFO:root:VAL   | Epoch: [42/50] | Loss: 0.7599 | AP: 38.84 | TP:78.0, FP:120.5, FN:51.0, TN:63.5 | ACC: 45.21
INFO:root:TRAIN | Epoch: [43/50] | Loss: 0.6189 | AP: 61.85 | TP:78.63, FP:78.11, FN:21.08, TN:75.41 | ACC: 60.87
INFO:root:VAL   | Epoch: [43/50] | Loss: 0.7612 | AP: 40.32 | TP:67.5, FP:113.0, FN:61.5, TN:71.0 | ACC: 44.25
INFO:root:TRAIN | Epoch: [44/50] | Loss: 0.6200 | AP: 62.19 | TP:79.17, FP:81.02, FN:20.55, TN:72.49 | ACC: 59.91
INFO:root:VAL   | Epoch: [44/50] | Loss: 0.7452 | AP: 42.21 | TP:72.0, FP:109.0, FN:57.0, TN:75.0 | ACC: 46.96
INFO:root:=> AP improved (42.21) improved at epoch 44 | saving best model!
INFO:root:TRAIN | Epoch: [45/50] | Loss: 0.6163 | AP: 62.53 | TP:75.77, FP:75.34, FN:23.96, TN:78.16 | ACC: 60.79
INFO:root:VAL   | Epoch: [45/50] | Loss: 0.7689 | AP: 38.93 | TP:82.5, FP:133.0, FN:46.5, TN:51.0 | ACC: 42.65
INFO:root:TRAIN | Epoch: [46/50] | Loss: 0.6168 | AP: 62.16 | TP:75.98, FP:75.15, FN:23.53, TN:78.57 | ACC: 61.02
INFO:root:VAL   | Epoch: [46/50] | Loss: 0.7557 | AP: 41.80 | TP:78.0, FP:114.5, FN:51.0, TN:69.5 | ACC: 47.12
INFO:root:TRAIN | Epoch: [47/50] | Loss: 0.6155 | AP: 62.99 | TP:78.94, FP:80.52, FN:20.73, TN:73.04 | ACC: 60.00
INFO:root:VAL   | Epoch: [47/50] | Loss: 0.7584 | AP: 40.66 | TP:74.0, FP:114.5, FN:55.0, TN:69.5 | ACC: 45.85
INFO:root:TRAIN | Epoch: [48/50] | Loss: 0.6124 | AP: 62.90 | TP:78.83, FP:79.98, FN:20.72, TN:73.70 | ACC: 60.25
INFO:root:VAL   | Epoch: [48/50] | Loss: 0.7516 | AP: 41.31 | TP:74.0, FP:112.0, FN:55.0, TN:72.0 | ACC: 46.65
INFO:root:TRAIN | Epoch: [49/50] | Loss: 0.6128 | AP: 63.20 | TP:76.91, FP:76.79, FN:22.76, TN:76.77 | ACC: 60.64
INFO:root:VAL   | Epoch: [49/50] | Loss: 0.7594 | AP: 40.46 | TP:73.0, FP:110.5, FN:56.0, TN:73.5 | ACC: 46.81
INFO:root:### Training from epoch 0 -> 49 finished in (58.41) minutes
INFO:root:### Best validation AP: 42.21 in epoch 44
INFO:root:# Test Set | Loss: 0.7420 | AP: 38.30 | TP:154.5, FP:220.0, FN:82.5, TN:126.0 | ACC: 48.11
INFO:root:Namespace(aggregation='max', batch_size=256, debug=False, device=device(type='cpu'), dropout=0.1, epochs=20, hidden_size=128, in_features=17, kernel_size=3, log_dir='exps/logs', lr=0.0001, model='GRU', num_channels=[64, 64, 128], num_classes=2, num_layers=2, num_workers=4, print_freq=5, root='data', save_dir='exps/chpts/GRU_layers2_stride5_max_lr0.0001', seed=14, start_epoch=0, tb_dir='exps/tb/GRU_layers2_stride5_max_lr0.0001', temp_stride=5)
INFO:root:GRU(
  (rnn): GRU(17, 128, num_layers=2, batch_first=True)
  (fc): Linear(in_features=128, out_features=2, bias=True)
  (avg_pool): AdaptiveAvgPool1d(output_size=1)
  (max_pool): AdaptiveMaxPool1d(output_size=1)
)
INFO:root:=> Loading 4792 samples for train
INFO:root:=> Loading 626 samples for val
INFO:root:=> Loading 1166 samples for test
INFO:root:TRAIN | Epoch: [0/20] | Loss: 0.6884 | AP: 42.64 | TP:91.11, FP:141.57, FN:8.55, TN:12.01 | ACC: 40.71
INFO:root:VAL   | Epoch: [0/20] | Loss: 0.6912 | AP: 31.52 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (31.52) improved at epoch 0 | saving best model!
INFO:root:TRAIN | Epoch: [1/20] | Loss: 0.6819 | AP: 46.38 | TP:99.56, FP:153.31, FN:0.21, TN:0.15 | ACC: 39.34
INFO:root:VAL   | Epoch: [1/20] | Loss: 0.6935 | AP: 31.75 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (31.75) improved at epoch 1 | saving best model!
INFO:root:TRAIN | Epoch: [2/20] | Loss: 0.6787 | AP: 48.37 | TP:97.73, FP:149.26, FN:1.97, TN:4.28 | ACC: 40.28
INFO:root:VAL   | Epoch: [2/20] | Loss: 0.6951 | AP: 32.26 | TP:123.0, FP:171.0, FN:6.0, TN:13.0 | ACC: 43.45
INFO:root:=> AP improved (32.26) improved at epoch 2 | saving best model!
INFO:root:TRAIN | Epoch: [3/20] | Loss: 0.6754 | AP: 49.22 | TP:93.96, FP:137.39, FN:5.66, TN:16.22 | ACC: 43.51
INFO:root:VAL   | Epoch: [3/20] | Loss: 0.6957 | AP: 33.52 | TP:116.5, FP:164.0, FN:12.5, TN:20.0 | ACC: 43.61
INFO:root:=> AP improved (33.52) improved at epoch 3 | saving best model!
INFO:root:TRAIN | Epoch: [4/20] | Loss: 0.6725 | AP: 50.60 | TP:92.31, FP:131.24, FN:7.40, TN:22.29 | ACC: 45.22
INFO:root:VAL   | Epoch: [4/20] | Loss: 0.7005 | AP: 33.70 | TP:111.5, FP:161.0, FN:17.5, TN:23.0 | ACC: 42.97
INFO:root:=> AP improved (33.70) improved at epoch 4 | saving best model!
INFO:root:TRAIN | Epoch: [5/20] | Loss: 0.6701 | AP: 50.79 | TP:90.12, FP:124.66, FN:9.55, TN:28.91 | ACC: 46.99
INFO:root:VAL   | Epoch: [5/20] | Loss: 0.7018 | AP: 34.46 | TP:105.5, FP:157.0, FN:23.5, TN:27.0 | ACC: 42.33
INFO:root:=> AP improved (34.46) improved at epoch 5 | saving best model!
INFO:root:TRAIN | Epoch: [6/20] | Loss: 0.6671 | AP: 51.56 | TP:87.00, FP:116.11, FN:12.79, TN:37.33 | ACC: 49.02
INFO:root:VAL   | Epoch: [6/20] | Loss: 0.7034 | AP: 34.78 | TP:107.5, FP:154.5, FN:21.5, TN:29.5 | ACC: 43.77
INFO:root:=> AP improved (34.78) improved at epoch 6 | saving best model!
INFO:root:TRAIN | Epoch: [7/20] | Loss: 0.6659 | AP: 51.70 | TP:86.19, FP:116.00, FN:13.44, TN:37.61 | ACC: 48.87
INFO:root:VAL   | Epoch: [7/20] | Loss: 0.7061 | AP: 35.05 | TP:102.5, FP:149.5, FN:26.5, TN:34.5 | ACC: 43.77
INFO:root:=> AP improved (35.05) improved at epoch 7 | saving best model!
INFO:root:TRAIN | Epoch: [8/20] | Loss: 0.6629 | AP: 52.77 | TP:82.65, FP:108.73, FN:17.07, TN:44.79 | ACC: 50.33
INFO:root:VAL   | Epoch: [8/20] | Loss: 0.7084 | AP: 35.49 | TP:101.5, FP:152.0, FN:27.5, TN:32.0 | ACC: 42.65
INFO:root:=> AP improved (35.49) improved at epoch 8 | saving best model!
INFO:root:TRAIN | Epoch: [9/20] | Loss: 0.6627 | AP: 52.53 | TP:85.05, FP:113.71, FN:14.48, TN:40.01 | ACC: 49.39
INFO:root:VAL   | Epoch: [9/20] | Loss: 0.7104 | AP: 36.52 | TP:92.5, FP:143.0, FN:36.5, TN:41.0 | ACC: 42.65
INFO:root:=> AP improved (36.52) improved at epoch 9 | saving best model!
INFO:root:TRAIN | Epoch: [10/20] | Loss: 0.6612 | AP: 53.08 | TP:83.83, FP:108.48, FN:15.81, TN:45.11 | ACC: 50.90
INFO:root:VAL   | Epoch: [10/20] | Loss: 0.7125 | AP: 35.68 | TP:98.0, FP:153.0, FN:31.0, TN:31.0 | ACC: 41.21
INFO:root:TRAIN | Epoch: [11/20] | Loss: 0.6589 | AP: 53.80 | TP:83.49, FP:107.73, FN:16.27, TN:45.74 | ACC: 50.98
INFO:root:VAL   | Epoch: [11/20] | Loss: 0.7105 | AP: 36.51 | TP:95.0, FP:147.0, FN:34.0, TN:37.0 | ACC: 42.17
INFO:root:TRAIN | Epoch: [12/20] | Loss: 0.6577 | AP: 53.67 | TP:83.39, FP:103.78, FN:16.37, TN:49.69 | ACC: 52.53
INFO:root:VAL   | Epoch: [12/20] | Loss: 0.7141 | AP: 36.89 | TP:88.5, FP:142.0, FN:40.5, TN:42.0 | ACC: 41.69
INFO:root:=> AP improved (36.89) improved at epoch 12 | saving best model!
INFO:root:TRAIN | Epoch: [13/20] | Loss: 0.6558 | AP: 54.88 | TP:83.40, FP:105.87, FN:16.24, TN:47.72 | ACC: 51.75
INFO:root:VAL   | Epoch: [13/20] | Loss: 0.7155 | AP: 37.70 | TP:87.5, FP:141.5, FN:41.5, TN:42.5 | ACC: 41.53
INFO:root:=> AP improved (37.70) improved at epoch 13 | saving best model!
INFO:root:TRAIN | Epoch: [14/20] | Loss: 0.6541 | AP: 55.02 | TP:82.28, FP:101.21, FN:17.30, TN:52.44 | ACC: 53.23
INFO:root:VAL   | Epoch: [14/20] | Loss: 0.7137 | AP: 38.71 | TP:87.0, FP:139.0, FN:42.0, TN:45.0 | ACC: 42.17
INFO:root:=> AP improved (38.71) improved at epoch 14 | saving best model!
INFO:root:TRAIN | Epoch: [15/20] | Loss: 0.6526 | AP: 55.50 | TP:80.72, FP:99.62, FN:18.83, TN:54.07 | ACC: 53.26
INFO:root:VAL   | Epoch: [15/20] | Loss: 0.7179 | AP: 38.09 | TP:88.5, FP:142.0, FN:40.5, TN:42.0 | ACC: 41.69
INFO:root:TRAIN | Epoch: [16/20] | Loss: 0.6508 | AP: 55.82 | TP:80.71, FP:98.79, FN:18.90, TN:54.83 | ACC: 53.53
INFO:root:VAL   | Epoch: [16/20] | Loss: 0.7178 | AP: 39.69 | TP:90.5, FP:139.5, FN:38.5, TN:44.5 | ACC: 43.13
INFO:root:=> AP improved (39.69) improved at epoch 16 | saving best model!
INFO:root:TRAIN | Epoch: [17/20] | Loss: 0.6493 | AP: 56.34 | TP:81.96, FP:101.64, FN:17.63, TN:52.01 | ACC: 52.90
INFO:root:VAL   | Epoch: [17/20] | Loss: 0.7250 | AP: 38.36 | TP:78.5, FP:133.0, FN:50.5, TN:51.0 | ACC: 41.37
INFO:root:TRAIN | Epoch: [18/20] | Loss: 0.6480 | AP: 56.19 | TP:80.93, FP:95.56, FN:18.75, TN:58.01 | ACC: 54.90
INFO:root:VAL   | Epoch: [18/20] | Loss: 0.7281 | AP: 38.27 | TP:84.0, FP:139.0, FN:45.0, TN:45.0 | ACC: 41.21
INFO:root:TRAIN | Epoch: [19/20] | Loss: 0.6473 | AP: 56.30 | TP:78.12, FP:91.23, FN:21.66, TN:62.23 | ACC: 55.40
INFO:root:VAL   | Epoch: [19/20] | Loss: 0.7276 | AP: 38.74 | TP:85.5, FP:143.5, FN:43.5, TN:40.5 | ACC: 40.26
INFO:root:### Training from epoch 0 -> 19 finished in (16.85) minutes
INFO:root:### Best validation AP: 39.69 in epoch 16
INFO:root:# Test Set | Loss: 0.6907 | AP: 42.75 | TP:195.0, FP:262.5, FN:42.0, TN:83.5 | ACC: 47.77
INFO:root:Namespace(aggregation='max', batch_size=256, debug=False, device=device(type='cpu'), dropout=0.1, epochs=30, hidden_size=128, in_features=17, kernel_size=3, log_dir='exps/logs', lr=0.0001, model='GRU', num_channels=[64, 64, 128], num_classes=2, num_layers=2, num_workers=4, print_freq=5, root='data', save_dir='exps/chpts/GRU_layers2_stride5_max_lr0.0001', seed=14, start_epoch=0, tb_dir='exps/tb/GRU_layers2_stride5_max_lr0.0001', temp_stride=5, wd=1e-05)
INFO:root:GRU(
  (rnn): GRU(17, 128, num_layers=2, batch_first=True)
  (fc): Linear(in_features=128, out_features=2, bias=True)
  (avg_pool): AdaptiveAvgPool1d(output_size=1)
  (max_pool): AdaptiveMaxPool1d(output_size=1)
)
INFO:root:=> Loading 4792 samples for train
INFO:root:=> Loading 626 samples for val
INFO:root:=> Loading 1166 samples for test
INFO:root:TRAIN | Epoch: [0/30] | Loss: 0.6884 | AP: 43.01 | TP:91.00, FP:141.25, FN:8.65, TN:12.33 | ACC: 40.80
INFO:root:VAL   | Epoch: [0/30] | Loss: 0.6916 | AP: 31.61 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (31.61) improved at epoch 0 | saving best model!
INFO:root:TRAIN | Epoch: [1/30] | Loss: 0.6813 | AP: 47.18 | TP:99.51, FP:153.26, FN:0.27, TN:0.20 | ACC: 39.34
INFO:root:VAL   | Epoch: [1/30] | Loss: 0.6938 | AP: 31.78 | TP:128.0, FP:183.5, FN:1.0, TN:0.5 | ACC: 41.05
INFO:root:=> AP improved (31.78) improved at epoch 1 | saving best model!
INFO:root:TRAIN | Epoch: [2/30] | Loss: 0.6785 | AP: 48.31 | TP:97.36, FP:147.85, FN:2.34, TN:5.68 | ACC: 40.67
INFO:root:VAL   | Epoch: [2/30] | Loss: 0.6958 | AP: 32.46 | TP:121.5, FP:170.5, FN:7.5, TN:13.5 | ACC: 43.13
INFO:root:=> AP improved (32.46) improved at epoch 2 | saving best model!
INFO:root:TRAIN | Epoch: [3/30] | Loss: 0.6748 | AP: 49.68 | TP:93.37, FP:136.88, FN:6.26, TN:16.73 | ACC: 43.45
INFO:root:VAL   | Epoch: [3/30] | Loss: 0.6961 | AP: 33.71 | TP:117.5, FP:163.0, FN:11.5, TN:21.0 | ACC: 44.25
INFO:root:=> AP improved (33.71) improved at epoch 3 | saving best model!
INFO:root:TRAIN | Epoch: [4/30] | Loss: 0.6726 | AP: 50.44 | TP:91.63, FP:129.53, FN:8.07, TN:24.00 | ACC: 45.64
INFO:root:VAL   | Epoch: [4/30] | Loss: 0.6988 | AP: 33.98 | TP:112.0, FP:162.0, FN:17.0, TN:22.0 | ACC: 42.81
INFO:root:=> AP improved (33.98) improved at epoch 4 | saving best model!
INFO:root:TRAIN | Epoch: [5/30] | Loss: 0.6693 | AP: 50.85 | TP:89.87, FP:123.85, FN:9.80, TN:29.71 | ACC: 47.20
INFO:root:VAL   | Epoch: [5/30] | Loss: 0.7037 | AP: 34.39 | TP:105.5, FP:155.5, FN:23.5, TN:28.5 | ACC: 42.81
INFO:root:=> AP improved (34.39) improved at epoch 5 | saving best model!
INFO:root:TRAIN | Epoch: [6/30] | Loss: 0.6677 | AP: 51.50 | TP:86.64, FP:116.00, FN:13.15, TN:37.44 | ACC: 48.91
INFO:root:VAL   | Epoch: [6/30] | Loss: 0.7042 | AP: 34.32 | TP:105.5, FP:154.5, FN:23.5, TN:29.5 | ACC: 43.13
INFO:root:TRAIN | Epoch: [7/30] | Loss: 0.6670 | AP: 51.36 | TP:86.29, FP:117.42, FN:13.34, TN:36.19 | ACC: 48.37
INFO:root:VAL   | Epoch: [7/30] | Loss: 0.7057 | AP: 35.23 | TP:102.5, FP:150.5, FN:26.5, TN:33.5 | ACC: 43.45
INFO:root:=> AP improved (35.23) improved at epoch 7 | saving best model!
INFO:root:TRAIN | Epoch: [8/30] | Loss: 0.6636 | AP: 52.64 | TP:83.20, FP:108.29, FN:16.52, TN:45.23 | ACC: 50.73
INFO:root:VAL   | Epoch: [8/30] | Loss: 0.7076 | AP: 35.40 | TP:100.5, FP:154.5, FN:28.5, TN:29.5 | ACC: 41.53
INFO:root:=> AP improved (35.40) improved at epoch 8 | saving best model!
INFO:root:TRAIN | Epoch: [9/30] | Loss: 0.6633 | AP: 52.53 | TP:85.91, FP:115.77, FN:13.61, TN:37.94 | ACC: 48.94
INFO:root:VAL   | Epoch: [9/30] | Loss: 0.7072 | AP: 36.66 | TP:92.5, FP:145.5, FN:36.5, TN:38.5 | ACC: 41.85
INFO:root:=> AP improved (36.66) improved at epoch 9 | saving best model!
INFO:root:TRAIN | Epoch: [10/30] | Loss: 0.6599 | AP: 53.65 | TP:84.41, FP:108.36, FN:15.24, TN:45.23 | ACC: 51.17
INFO:root:VAL   | Epoch: [10/30] | Loss: 0.7077 | AP: 36.96 | TP:98.0, FP:152.0, FN:31.0, TN:32.0 | ACC: 41.53
INFO:root:=> AP improved (36.96) improved at epoch 10 | saving best model!
INFO:root:TRAIN | Epoch: [11/30] | Loss: 0.6598 | AP: 53.47 | TP:83.08, FP:106.67, FN:16.69, TN:46.81 | ACC: 51.25
INFO:root:VAL   | Epoch: [11/30] | Loss: 0.7094 | AP: 36.79 | TP:92.0, FP:146.5, FN:37.0, TN:37.5 | ACC: 41.37
INFO:root:TRAIN | Epoch: [12/30] | Loss: 0.6569 | AP: 53.86 | TP:82.31, FP:103.70, FN:17.46, TN:49.78 | ACC: 52.13
INFO:root:VAL   | Epoch: [12/30] | Loss: 0.7121 | AP: 37.58 | TP:91.0, FP:141.0, FN:38.0, TN:43.0 | ACC: 42.81
INFO:root:=> AP improved (37.58) improved at epoch 12 | saving best model!
INFO:root:TRAIN | Epoch: [13/30] | Loss: 0.6552 | AP: 54.63 | TP:83.13, FP:104.79, FN:16.51, TN:48.80 | ACC: 52.09
INFO:root:VAL   | Epoch: [13/30] | Loss: 0.7166 | AP: 37.66 | TP:86.0, FP:141.0, FN:43.0, TN:43.0 | ACC: 41.21
INFO:root:=> AP improved (37.66) improved at epoch 13 | saving best model!
INFO:root:TRAIN | Epoch: [14/30] | Loss: 0.6537 | AP: 54.76 | TP:81.65, FP:100.50, FN:17.94, TN:53.16 | ACC: 53.30
INFO:root:VAL   | Epoch: [14/30] | Loss: 0.7170 | AP: 38.35 | TP:88.0, FP:142.0, FN:41.0, TN:42.0 | ACC: 41.53
INFO:root:=> AP improved (38.35) improved at epoch 14 | saving best model!
INFO:root:TRAIN | Epoch: [15/30] | Loss: 0.6527 | AP: 55.03 | TP:81.65, FP:100.21, FN:17.90, TN:53.47 | ACC: 53.42
INFO:root:VAL   | Epoch: [15/30] | Loss: 0.7172 | AP: 38.77 | TP:86.5, FP:140.5, FN:42.5, TN:43.5 | ACC: 41.53
INFO:root:=> AP improved (38.77) improved at epoch 15 | saving best model!
INFO:root:TRAIN | Epoch: [16/30] | Loss: 0.6507 | AP: 55.54 | TP:80.35, FP:97.76, FN:19.26, TN:55.87 | ACC: 53.80
INFO:root:VAL   | Epoch: [16/30] | Loss: 0.7240 | AP: 38.45 | TP:87.0, FP:140.5, FN:42.0, TN:43.5 | ACC: 41.69
INFO:root:TRAIN | Epoch: [17/30] | Loss: 0.6496 | AP: 56.33 | TP:80.53, FP:99.06, FN:19.05, TN:54.59 | ACC: 53.38
INFO:root:VAL   | Epoch: [17/30] | Loss: 0.7228 | AP: 38.61 | TP:79.0, FP:132.5, FN:50.0, TN:51.5 | ACC: 41.69
INFO:root:TRAIN | Epoch: [18/30] | Loss: 0.6494 | AP: 55.93 | TP:80.51, FP:98.52, FN:19.17, TN:55.04 | ACC: 53.59
INFO:root:VAL   | Epoch: [18/30] | Loss: 0.7255 | AP: 38.21 | TP:84.0, FP:137.5, FN:45.0, TN:46.5 | ACC: 41.69
INFO:root:TRAIN | Epoch: [19/30] | Loss: 0.6469 | AP: 56.75 | TP:79.16, FP:93.37, FN:20.62, TN:60.09 | ACC: 54.95
INFO:root:VAL   | Epoch: [19/30] | Loss: 0.7316 | AP: 37.39 | TP:85.0, FP:138.5, FN:44.0, TN:45.5 | ACC: 41.69
INFO:root:TRAIN | Epoch: [20/30] | Loss: 0.6452 | AP: 56.66 | TP:78.11, FP:90.27, FN:21.56, TN:63.29 | ACC: 55.78
INFO:root:VAL   | Epoch: [20/30] | Loss: 0.7385 | AP: 37.75 | TP:79.5, FP:135.5, FN:49.5, TN:48.5 | ACC: 40.89
INFO:root:TRAIN | Epoch: [21/30] | Loss: 0.6443 | AP: 56.88 | TP:79.07, FP:92.07, FN:20.50, TN:61.60 | ACC: 55.55
INFO:root:VAL   | Epoch: [21/30] | Loss: 0.7303 | AP: 39.47 | TP:79.0, FP:133.0, FN:50.0, TN:51.0 | ACC: 41.53
INFO:root:=> AP improved (39.47) improved at epoch 21 | saving best model!
INFO:root:TRAIN | Epoch: [22/30] | Loss: 0.6424 | AP: 57.39 | TP:78.76, FP:89.74, FN:20.82, TN:63.91 | ACC: 56.32
INFO:root:VAL   | Epoch: [22/30] | Loss: 0.7337 | AP: 39.35 | TP:78.0, FP:131.0, FN:51.0, TN:53.0 | ACC: 41.85
INFO:root:TRAIN | Epoch: [23/30] | Loss: 0.6425 | AP: 57.71 | TP:77.32, FP:87.10, FN:22.11, TN:66.70 | ACC: 56.89
INFO:root:VAL   | Epoch: [23/30] | Loss: 0.7451 | AP: 38.40 | TP:82.0, FP:139.5, FN:47.0, TN:44.5 | ACC: 40.42
INFO:root:TRAIN | Epoch: [24/30] | Loss: 0.6421 | AP: 57.86 | TP:79.49, FP:93.94, FN:20.30, TN:59.50 | ACC: 54.86
INFO:root:VAL   | Epoch: [24/30] | Loss: 0.7415 | AP: 37.98 | TP:75.0, FP:130.0, FN:54.0, TN:54.0 | ACC: 41.21
INFO:root:TRAIN | Epoch: [25/30] | Loss: 0.6408 | AP: 57.96 | TP:77.50, FP:87.58, FN:22.13, TN:66.03 | ACC: 56.59
INFO:root:VAL   | Epoch: [25/30] | Loss: 0.7398 | AP: 39.87 | TP:78.0, FP:133.0, FN:51.0, TN:51.0 | ACC: 41.21
INFO:root:=> AP improved (39.87) improved at epoch 25 | saving best model!
INFO:root:TRAIN | Epoch: [26/30] | Loss: 0.6386 | AP: 58.26 | TP:77.12, FP:83.85, FN:22.37, TN:69.90 | ACC: 58.10
INFO:root:VAL   | Epoch: [26/30] | Loss: 0.7337 | AP: 39.08 | TP:80.0, FP:127.0, FN:49.0, TN:57.0 | ACC: 43.77
INFO:root:TRAIN | Epoch: [27/30] | Loss: 0.6381 | AP: 58.46 | TP:77.43, FP:86.38, FN:22.33, TN:67.10 | ACC: 57.10
INFO:root:VAL   | Epoch: [27/30] | Loss: 0.7453 | AP: 38.43 | TP:74.0, FP:130.5, FN:55.0, TN:53.5 | ACC: 40.73
INFO:root:TRAIN | Epoch: [28/30] | Loss: 0.6366 | AP: 58.87 | TP:78.12, FP:85.96, FN:21.62, TN:67.54 | ACC: 57.51
INFO:root:VAL   | Epoch: [28/30] | Loss: 0.7386 | AP: 38.65 | TP:74.0, FP:124.0, FN:55.0, TN:60.0 | ACC: 42.81
INFO:root:TRAIN | Epoch: [29/30] | Loss: 0.6346 | AP: 59.07 | TP:78.50, FP:87.30, FN:21.18, TN:66.27 | ACC: 57.20
INFO:root:VAL   | Epoch: [29/30] | Loss: 0.7399 | AP: 39.33 | TP:73.5, FP:117.0, FN:55.5, TN:67.0 | ACC: 44.89
INFO:root:### Training from epoch 0 -> 29 finished in (25.68) minutes
INFO:root:### Best validation AP: 39.87 in epoch 25
INFO:root:# Test Set | Loss: 0.7119 | AP: 41.07 | TP:181.5, FP:243.5, FN:55.5, TN:102.5 | ACC: 48.71
