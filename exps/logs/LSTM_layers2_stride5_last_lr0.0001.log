INFO:root:Namespace(aggregation='last', batch_size=256, debug=False, device=device(type='cpu'), dropout=0.1, epochs=20, hidden_size=128, in_features=17, kernel_size=3, log_dir='exps/logs', lr=0.0001, model='LSTM', num_channels=[64, 64, 128], num_classes=2, num_layers=2, num_workers=4, print_freq=5, root='data', save_dir='exps/chpts/LSTM_layers2_stride5_last_lr0.0001', seed=14, start_epoch=0, tb_dir='exps/tb/LSTM_layers2_stride5_last_lr0.0001', temp_stride=5)
INFO:root:LSTM(
  (rnn): LSTM(17, 128, num_layers=2, batch_first=True)
  (fc): Linear(in_features=128, out_features=2, bias=True)
  (avg_pool): AdaptiveAvgPool1d(output_size=1)
  (max_pool): AdaptiveMaxPool1d(output_size=1)
)
INFO:root:=> Loading 4792 samples for train
INFO:root:=> Loading 626 samples for val
INFO:root:=> Loading 1166 samples for test
INFO:root:TRAIN | Epoch: [0/20] | Loss: 0.6914 | AP: 41.63 | TP:70.44, FP:106.19, FN:29.22, TN:47.39 | ACC: 46.45
INFO:root:VAL   | Epoch: [0/20] | Loss: 0.6890 | AP: 36.25 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (36.25) improved at epoch 0 | saving best model!
INFO:root:TRAIN | Epoch: [1/20] | Loss: 0.6853 | AP: 44.37 | TP:99.75, FP:153.49, FN:0.00, TN:0.00 | ACC: 39.36
INFO:root:VAL   | Epoch: [1/20] | Loss: 0.6876 | AP: 34.45 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:TRAIN | Epoch: [2/20] | Loss: 0.6815 | AP: 46.26 | TP:99.44, FP:153.13, FN:0.21, TN:0.45 | ACC: 39.46
INFO:root:VAL   | Epoch: [2/20] | Loss: 0.6900 | AP: 33.44 | TP:128.0, FP:181.0, FN:1.0, TN:3.0 | ACC: 41.85
INFO:root:TRAIN | Epoch: [3/20] | Loss: 0.6777 | AP: 47.00 | TP:97.28, FP:147.55, FN:2.37, TN:6.03 | ACC: 40.84
INFO:root:VAL   | Epoch: [3/20] | Loss: 0.6949 | AP: 33.21 | TP:124.0, FP:166.0, FN:5.0, TN:18.0 | ACC: 45.37
INFO:root:TRAIN | Epoch: [4/20] | Loss: 0.6751 | AP: 47.71 | TP:91.57, FP:133.02, FN:8.05, TN:20.60 | ACC: 44.34
INFO:root:VAL   | Epoch: [4/20] | Loss: 0.7025 | AP: 33.38 | TP:112.5, FP:156.0, FN:16.5, TN:28.0 | ACC: 44.89
INFO:root:TRAIN | Epoch: [5/20] | Loss: 0.6717 | AP: 48.54 | TP:87.70, FP:121.39, FN:12.05, TN:32.10 | ACC: 47.31
INFO:root:VAL   | Epoch: [5/20] | Loss: 0.7117 | AP: 33.42 | TP:107.5, FP:150.5, FN:21.5, TN:33.5 | ACC: 45.05
INFO:root:TRAIN | Epoch: [6/20] | Loss: 0.6693 | AP: 49.17 | TP:84.02, FP:113.26, FN:15.72, TN:40.24 | ACC: 49.02
INFO:root:VAL   | Epoch: [6/20] | Loss: 0.7223 | AP: 33.36 | TP:99.5, FP:145.5, FN:29.5, TN:38.5 | ACC: 44.09
INFO:root:TRAIN | Epoch: [7/20] | Loss: 0.6684 | AP: 49.58 | TP:83.52, FP:110.50, FN:16.17, TN:43.05 | ACC: 49.96
INFO:root:VAL   | Epoch: [7/20] | Loss: 0.7220 | AP: 34.17 | TP:103.0, FP:150.0, FN:26.0, TN:34.0 | ACC: 43.77
INFO:root:TRAIN | Epoch: [8/20] | Loss: 0.6677 | AP: 50.44 | TP:83.98, FP:112.23, FN:15.54, TN:41.48 | ACC: 49.62
INFO:root:VAL   | Epoch: [8/20] | Loss: 0.7136 | AP: 35.43 | TP:96.0, FP:138.5, FN:33.0, TN:45.5 | ACC: 45.21
INFO:root:TRAIN | Epoch: [9/20] | Loss: 0.6645 | AP: 51.11 | TP:81.98, FP:105.81, FN:17.72, TN:47.72 | ACC: 51.17
INFO:root:VAL   | Epoch: [9/20] | Loss: 0.7292 | AP: 35.47 | TP:95.0, FP:144.0, FN:34.0, TN:40.0 | ACC: 43.13
INFO:root:TRAIN | Epoch: [10/20] | Loss: 0.6636 | AP: 51.46 | TP:82.11, FP:104.26, FN:17.58, TN:49.29 | ACC: 51.88
INFO:root:VAL   | Epoch: [10/20] | Loss: 0.7231 | AP: 36.35 | TP:98.0, FP:141.5, FN:31.0, TN:42.5 | ACC: 44.89
INFO:root:=> AP improved (36.35) improved at epoch 10 | saving best model!
INFO:root:TRAIN | Epoch: [11/20] | Loss: 0.6628 | AP: 52.05 | TP:81.92, FP:105.15, FN:17.70, TN:48.45 | ACC: 51.44
INFO:root:VAL   | Epoch: [11/20] | Loss: 0.7222 | AP: 37.30 | TP:93.0, FP:141.5, FN:36.0, TN:42.5 | ACC: 43.29
INFO:root:=> AP improved (37.30) improved at epoch 11 | saving best model!
INFO:root:TRAIN | Epoch: [12/20] | Loss: 0.6604 | AP: 52.97 | TP:81.23, FP:104.07, FN:18.34, TN:49.60 | ACC: 51.67
INFO:root:VAL   | Epoch: [12/20] | Loss: 0.7353 | AP: 36.10 | TP:90.5, FP:142.0, FN:38.5, TN:42.0 | ACC: 42.33
INFO:root:TRAIN | Epoch: [13/20] | Loss: 0.6586 | AP: 53.63 | TP:80.46, FP:100.14, FN:19.39, TN:53.24 | ACC: 52.80
INFO:root:VAL   | Epoch: [13/20] | Loss: 0.7318 | AP: 36.66 | TP:90.0, FP:143.5, FN:39.0, TN:40.5 | ACC: 41.69
INFO:root:TRAIN | Epoch: [14/20] | Loss: 0.6583 | AP: 53.77 | TP:80.17, FP:101.90, FN:19.56, TN:51.60 | ACC: 52.02
INFO:root:VAL   | Epoch: [14/20] | Loss: 0.7322 | AP: 36.80 | TP:87.5, FP:133.0, FN:41.5, TN:51.0 | ACC: 44.25
INFO:root:TRAIN | Epoch: [15/20] | Loss: 0.6548 | AP: 54.48 | TP:77.66, FP:94.13, FN:22.04, TN:59.40 | ACC: 54.09
INFO:root:VAL   | Epoch: [15/20] | Loss: 0.7570 | AP: 36.23 | TP:95.5, FP:145.5, FN:33.5, TN:38.5 | ACC: 42.81
INFO:root:TRAIN | Epoch: [16/20] | Loss: 0.6531 | AP: 55.34 | TP:79.61, FP:97.53, FN:20.05, TN:56.05 | ACC: 53.61
INFO:root:VAL   | Epoch: [16/20] | Loss: 0.7431 | AP: 37.04 | TP:83.5, FP:132.0, FN:45.5, TN:52.0 | ACC: 43.29
INFO:root:TRAIN | Epoch: [17/20] | Loss: 0.6531 | AP: 55.51 | TP:78.41, FP:95.11, FN:21.33, TN:58.40 | ACC: 54.09
INFO:root:VAL   | Epoch: [17/20] | Loss: 0.7434 | AP: 36.80 | TP:79.0, FP:126.5, FN:50.0, TN:57.5 | ACC: 43.61
INFO:root:TRAIN | Epoch: [18/20] | Loss: 0.6513 | AP: 56.26 | TP:76.43, FP:91.17, FN:23.30, TN:62.33 | ACC: 54.82
INFO:root:VAL   | Epoch: [18/20] | Loss: 0.7370 | AP: 37.30 | TP:75.0, FP:115.5, FN:54.0, TN:68.5 | ACC: 45.85
INFO:root:=> AP improved (37.30) improved at epoch 18 | saving best model!
INFO:root:TRAIN | Epoch: [19/20] | Loss: 0.6494 | AP: 56.57 | TP:76.96, FP:91.73, FN:22.69, TN:61.84 | ACC: 54.86
INFO:root:VAL   | Epoch: [19/20] | Loss: 0.7531 | AP: 37.33 | TP:77.5, FP:122.5, FN:51.5, TN:61.5 | ACC: 44.41
INFO:root:=> AP improved (37.33) improved at epoch 19 | saving best model!
INFO:root:### Training from epoch 0 -> 19 finished in (16.78) minutes
INFO:root:### Best validation AP: 37.33 in epoch 19
INFO:root:# Test Set | Loss: 0.7208 | AP: 41.62 | TP:172.5, FP:231.0, FN:64.5, TN:115.0 | ACC: 49.31
INFO:root:Namespace(aggregation='last', batch_size=256, debug=False, device=device(type='cpu'), dropout=0.1, epochs=30, hidden_size=128, in_features=17, kernel_size=3, log_dir='exps/logs', lr=0.0001, model='LSTM', num_channels=[64, 64, 128], num_classes=2, num_layers=2, num_workers=4, print_freq=5, root='data', save_dir='exps/chpts/LSTM_layers2_stride5_last_lr0.0001', seed=14, start_epoch=0, tb_dir='exps/tb/LSTM_layers2_stride5_last_lr0.0001', temp_stride=5, wd=1e-05)
INFO:root:LSTM(
  (rnn): LSTM(17, 128, num_layers=2, batch_first=True)
  (fc): Linear(in_features=128, out_features=2, bias=True)
  (avg_pool): AdaptiveAvgPool1d(output_size=1)
  (max_pool): AdaptiveMaxPool1d(output_size=1)
)
INFO:root:=> Loading 4792 samples for train
INFO:root:=> Loading 626 samples for val
INFO:root:=> Loading 1166 samples for test
INFO:root:TRAIN | Epoch: [0/30] | Loss: 0.6914 | AP: 41.99 | TP:69.69, FP:105.71, FN:29.97, TN:47.87 | ACC: 46.35
INFO:root:VAL   | Epoch: [0/30] | Loss: 0.6894 | AP: 35.83 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:=> AP improved (35.83) improved at epoch 0 | saving best model!
INFO:root:TRAIN | Epoch: [1/30] | Loss: 0.6853 | AP: 44.68 | TP:99.75, FP:153.49, FN:0.00, TN:0.00 | ACC: 39.36
INFO:root:VAL   | Epoch: [1/30] | Loss: 0.6872 | AP: 34.96 | TP:129.0, FP:184.0, FN:0.0, TN:0.0 | ACC: 41.21
INFO:root:TRAIN | Epoch: [2/30] | Loss: 0.6818 | AP: 45.70 | TP:99.44, FP:153.42, FN:0.21, TN:0.16 | ACC: 39.34
INFO:root:VAL   | Epoch: [2/30] | Loss: 0.6905 | AP: 33.18 | TP:128.5, FP:181.5, FN:0.5, TN:2.5 | ACC: 41.85
INFO:root:TRAIN | Epoch: [3/30] | Loss: 0.6782 | AP: 46.81 | TP:97.01, FP:147.74, FN:2.65, TN:5.83 | ACC: 40.63
INFO:root:VAL   | Epoch: [3/30] | Loss: 0.6947 | AP: 33.13 | TP:121.0, FP:170.0, FN:8.0, TN:14.0 | ACC: 43.13
INFO:root:TRAIN | Epoch: [4/30] | Loss: 0.6751 | AP: 47.71 | TP:92.38, FP:133.26, FN:7.23, TN:20.36 | ACC: 44.57
INFO:root:VAL   | Epoch: [4/30] | Loss: 0.7056 | AP: 32.51 | TP:113.0, FP:156.5, FN:16.0, TN:27.5 | ACC: 44.89
INFO:root:TRAIN | Epoch: [5/30] | Loss: 0.6740 | AP: 47.32 | TP:87.69, FP:121.50, FN:12.06, TN:31.99 | ACC: 47.27
INFO:root:VAL   | Epoch: [5/30] | Loss: 0.7111 | AP: 33.32 | TP:110.0, FP:151.5, FN:19.0, TN:32.5 | ACC: 45.53
INFO:root:TRAIN | Epoch: [6/30] | Loss: 0.6688 | AP: 49.24 | TP:84.92, FP:114.35, FN:14.82, TN:39.15 | ACC: 48.96
INFO:root:VAL   | Epoch: [6/30] | Loss: 0.7184 | AP: 33.62 | TP:100.5, FP:146.5, FN:28.5, TN:37.5 | ACC: 44.09
INFO:root:TRAIN | Epoch: [7/30] | Loss: 0.6684 | AP: 49.60 | TP:82.96, FP:110.01, FN:16.73, TN:43.54 | ACC: 49.92
INFO:root:VAL   | Epoch: [7/30] | Loss: 0.7211 | AP: 34.40 | TP:104.0, FP:148.5, FN:25.0, TN:35.5 | ACC: 44.57
INFO:root:TRAIN | Epoch: [8/30] | Loss: 0.6680 | AP: 50.31 | TP:83.57, FP:111.62, FN:15.95, TN:42.09 | ACC: 49.75
INFO:root:VAL   | Epoch: [8/30] | Loss: 0.7129 | AP: 35.67 | TP:97.0, FP:142.5, FN:32.0, TN:41.5 | ACC: 44.25
INFO:root:TRAIN | Epoch: [9/30] | Loss: 0.6658 | AP: 50.95 | TP:81.92, FP:106.97, FN:17.78, TN:46.56 | ACC: 50.69
INFO:root:VAL   | Epoch: [9/30] | Loss: 0.7258 | AP: 35.36 | TP:95.0, FP:144.5, FN:34.0, TN:39.5 | ACC: 42.97
INFO:root:TRAIN | Epoch: [10/30] | Loss: 0.6633 | AP: 51.66 | TP:81.60, FP:105.25, FN:18.08, TN:48.30 | ACC: 51.27
INFO:root:VAL   | Epoch: [10/30] | Loss: 0.7248 | AP: 35.81 | TP:96.5, FP:143.5, FN:32.5, TN:40.5 | ACC: 43.77
INFO:root:TRAIN | Epoch: [11/30] | Loss: 0.6622 | AP: 52.19 | TP:82.25, FP:106.04, FN:17.38, TN:47.57 | ACC: 51.21
INFO:root:VAL   | Epoch: [11/30] | Loss: 0.7207 | AP: 36.48 | TP:93.0, FP:141.0, FN:36.0, TN:43.0 | ACC: 43.45
INFO:root:=> AP improved (36.48) improved at epoch 11 | saving best model!
INFO:root:TRAIN | Epoch: [12/30] | Loss: 0.6609 | AP: 53.24 | TP:81.58, FP:105.76, FN:17.99, TN:47.91 | ACC: 51.13
INFO:root:VAL   | Epoch: [12/30] | Loss: 0.7261 | AP: 37.30 | TP:93.5, FP:143.5, FN:35.5, TN:40.5 | ACC: 42.81
INFO:root:=> AP improved (37.30) improved at epoch 12 | saving best model!
INFO:root:TRAIN | Epoch: [13/30] | Loss: 0.6578 | AP: 53.44 | TP:79.44, FP:97.89, FN:20.41, TN:55.49 | ACC: 53.32
INFO:root:VAL   | Epoch: [13/30] | Loss: 0.7298 | AP: 36.95 | TP:88.5, FP:137.0, FN:40.5, TN:47.0 | ACC: 43.29
INFO:root:TRAIN | Epoch: [14/30] | Loss: 0.6567 | AP: 54.19 | TP:80.96, FP:101.24, FN:18.77, TN:52.26 | ACC: 52.59
INFO:root:VAL   | Epoch: [14/30] | Loss: 0.7288 | AP: 37.56 | TP:87.5, FP:132.0, FN:41.5, TN:52.0 | ACC: 44.57
INFO:root:=> AP improved (37.56) improved at epoch 14 | saving best model!
INFO:root:TRAIN | Epoch: [15/30] | Loss: 0.6548 | AP: 54.19 | TP:77.18, FP:93.34, FN:22.52, TN:60.19 | ACC: 54.24
INFO:root:VAL   | Epoch: [15/30] | Loss: 0.7576 | AP: 36.18 | TP:92.0, FP:140.0, FN:37.0, TN:44.0 | ACC: 43.45
INFO:root:TRAIN | Epoch: [16/30] | Loss: 0.6538 | AP: 55.09 | TP:77.33, FP:94.43, FN:22.33, TN:59.15 | ACC: 53.92
INFO:root:VAL   | Epoch: [16/30] | Loss: 0.7406 | AP: 37.10 | TP:83.0, FP:130.0, FN:46.0, TN:54.0 | ACC: 43.77
INFO:root:TRAIN | Epoch: [17/30] | Loss: 0.6505 | AP: 55.93 | TP:78.47, FP:94.31, FN:21.27, TN:59.20 | ACC: 54.40
INFO:root:VAL   | Epoch: [17/30] | Loss: 0.7404 | AP: 37.30 | TP:80.0, FP:125.5, FN:49.0, TN:58.5 | ACC: 44.25
INFO:root:TRAIN | Epoch: [18/30] | Loss: 0.6518 | AP: 55.92 | TP:77.38, FP:90.50, FN:22.36, TN:63.01 | ACC: 55.45
INFO:root:VAL   | Epoch: [18/30] | Loss: 0.7296 | AP: 38.03 | TP:76.0, FP:115.5, FN:53.0, TN:68.5 | ACC: 46.17
INFO:root:=> AP improved (38.03) improved at epoch 18 | saving best model!
INFO:root:TRAIN | Epoch: [19/30] | Loss: 0.6483 | AP: 56.57 | TP:78.58, FP:91.65, FN:21.08, TN:61.93 | ACC: 55.51
INFO:root:VAL   | Epoch: [19/30] | Loss: 0.7524 | AP: 37.21 | TP:77.0, FP:121.0, FN:52.0, TN:63.0 | ACC: 44.73
INFO:root:TRAIN | Epoch: [20/30] | Loss: 0.6492 | AP: 56.62 | TP:75.27, FP:84.51, FN:24.42, TN:69.04 | ACC: 56.97
INFO:root:VAL   | Epoch: [20/30] | Loss: 0.7700 | AP: 36.77 | TP:87.5, FP:131.0, FN:41.5, TN:53.0 | ACC: 44.89
INFO:root:TRAIN | Epoch: [21/30] | Loss: 0.6471 | AP: 57.27 | TP:74.62, FP:84.66, FN:25.02, TN:68.93 | ACC: 56.66
INFO:root:VAL   | Epoch: [21/30] | Loss: 0.7806 | AP: 36.89 | TP:87.0, FP:138.5, FN:42.0, TN:45.5 | ACC: 42.33
INFO:root:TRAIN | Epoch: [22/30] | Loss: 0.6451 | AP: 57.80 | TP:77.33, FP:89.71, FN:22.27, TN:63.93 | ACC: 55.70
INFO:root:VAL   | Epoch: [22/30] | Loss: 0.7697 | AP: 36.78 | TP:82.0, FP:129.0, FN:47.0, TN:55.0 | ACC: 43.77
INFO:root:TRAIN | Epoch: [23/30] | Loss: 0.6427 | AP: 58.06 | TP:76.56, FP:88.97, FN:23.13, TN:64.58 | ACC: 55.76
INFO:root:VAL   | Epoch: [23/30] | Loss: 0.7680 | AP: 36.54 | TP:70.0, FP:115.5, FN:59.0, TN:68.5 | ACC: 44.25
INFO:root:TRAIN | Epoch: [24/30] | Loss: 0.6423 | AP: 58.18 | TP:74.22, FP:82.40, FN:25.51, TN:71.10 | ACC: 57.28
INFO:root:VAL   | Epoch: [24/30] | Loss: 0.7615 | AP: 37.26 | TP:75.5, FP:118.5, FN:53.5, TN:65.5 | ACC: 45.05
INFO:root:TRAIN | Epoch: [25/30] | Loss: 0.6388 | AP: 59.22 | TP:77.12, FP:87.58, FN:22.61, TN:65.92 | ACC: 56.47
INFO:root:VAL   | Epoch: [25/30] | Loss: 0.7872 | AP: 36.89 | TP:78.0, FP:124.5, FN:51.0, TN:59.5 | ACC: 43.93
INFO:root:TRAIN | Epoch: [26/30] | Loss: 0.6408 | AP: 58.79 | TP:71.31, FP:77.87, FN:28.47, TN:75.58 | ACC: 58.01
INFO:root:VAL   | Epoch: [26/30] | Loss: 0.8160 | AP: 36.52 | TP:75.5, FP:126.5, FN:53.5, TN:57.5 | ACC: 42.49
INFO:root:TRAIN | Epoch: [27/30] | Loss: 0.6394 | AP: 59.49 | TP:74.91, FP:83.20, FN:24.73, TN:70.39 | ACC: 57.35
INFO:root:VAL   | Epoch: [27/30] | Loss: 0.7762 | AP: 36.53 | TP:74.5, FP:124.5, FN:54.5, TN:59.5 | ACC: 42.81
INFO:root:TRAIN | Epoch: [28/30] | Loss: 0.6340 | AP: 60.18 | TP:76.15, FP:82.94, FN:23.36, TN:70.79 | ACC: 58.06
INFO:root:VAL   | Epoch: [28/30] | Loss: 0.7804 | AP: 36.76 | TP:66.5, FP:110.0, FN:62.5, TN:74.0 | ACC: 44.89
INFO:root:TRAIN | Epoch: [29/30] | Loss: 0.6312 | AP: 61.00 | TP:73.79, FP:78.06, FN:25.98, TN:75.40 | ACC: 58.85
INFO:root:VAL   | Epoch: [29/30] | Loss: 0.7817 | AP: 37.90 | TP:68.5, FP:106.5, FN:60.5, TN:77.5 | ACC: 46.65
INFO:root:### Training from epoch 0 -> 29 finished in (26.95) minutes
INFO:root:### Best validation AP: 38.03 in epoch 18
INFO:root:# Test Set | Loss: 0.7087 | AP: 42.11 | TP:167.0, FP:221.0, FN:70.0, TN:125.0 | ACC: 50.09
